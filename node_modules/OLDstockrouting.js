var express = require('express');
var df = require('dateformat');
var passport = require('passport');
var router = express.Router();
var mysql = require('mysql');
var cfg = require('config');
var sqlhelper = require('mysqlhelper2');


//
router.get("/stock/managment.html", function (req,resp) {
	
	var liste={};
	var sql='SELECT products.id, products.label, products.stock, stock.qty, stock.idsupplier FROM STOCK,PRODUCTS WHERE products.id = stock.idproduct GROUP BY products.id, stock.qty, stock.idsupplier'
	sqlhelper.pool.query(sql, function (err, rows, fields) {						
		if(err){
			console.log('Il y a une erreur'+err);	
			}
			else{
				liste=rows;
				resp.render("admin/managment.html.twig",{"liststocks":liste});
				}		
	});	
});

//POST

router.post("/stock/list.html", function (req,resp) {
//	var datarange = req.body.reservation;
//	dates=datarange.split(' ');	
//	var datedebut = dates[0];
//	var datefin = dates[2];
//	
//	
//	var liststocks= [];

	
	sqlhelper.pool.query("SELECT * FROM stock ",[], function (err, rows, fields){
		if(err){
			console.log('Il y a une erreur'+err);	
			}
			else{
				liststocks=rows;
				resp.render("admin/stocks.html.twig",{"liststocks":liststocks});
				}	
	});
});

router.post("/stock/managment.html", function (req,resp) {





});



//exportation du module
module.exports = router;
